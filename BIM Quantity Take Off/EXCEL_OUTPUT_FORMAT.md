# Excel BOQ Output Format

This document describes the structure and format of the Excel output generated by the BIM QTO Tool.

## Workbook Structure

The Excel workbook contains multiple sheets:

1. **Element Type Sheets** (one per type found): Wall, Slab, Column, Beam, Footing
2. **Summary Sheet**: Aggregated statistics
3. **Project Information Sheet**: IFC file metadata

## BOQ Sheet Format (Example: "Wall" Sheet)

Each element type sheet follows this structure:

### Column Headers

| Column | Header | Description | Data Type | Example |
|--------|--------|-------------|-----------|---------|
| A | Item No | Sequential item number | Integer | 1, 2, 3... |
| B | Element Type | IFC element type | Text | IfcWall, IfcSlab |
| C | Description | Human-readable description | Text | Wall - Concrete |
| D | Unit | Unit of measurement | Text | m³, m², m, No. |
| E | Quantity | Primary quantity value | Decimal (3 places) | 125.500 |
| F | Storey | Building storey name | Text | Ground Floor |
| G | Material | Material name | Text | Concrete |
| H | volume_m3 | Volume in cubic meters | Decimal (3 places) | 125.500 |
| I | area_m2 | Area in square meters | Decimal (3 places) | 450.250 |
| J | length_m | Length in meters | Decimal (3 places) | 50.000 |
| K | count | Element count | Integer | 10 |

### Sample Data

```
| Item No | Element Type | Description      | Unit | Quantity | Storey      | Material  | volume_m3 | area_m2 | length_m | count |
|---------|--------------|------------------|------|----------|-------------|-----------|-----------|---------|----------|-------|
| 1       | IfcWall      | Wall - Concrete  | m³   | 125.500  | Ground Floor| Concrete  | 125.500   | 450.250 | 0.000    | 5     |
| 2       | IfcWall      | Wall - Brick     | m²   | 320.750  | First Floor | Brick     | 0.000     | 320.750 | 0.000    | 8     |
| 3       | IfcWall      | Wall - Concrete  | m³   | 95.250   | First Floor | Concrete  | 95.250    | 285.000 | 0.000    | 4     |
```

### Formatting

- **Header Row (Row 1)**:
  - Background color: Blue (#366092)
  - Font: Bold, White, Size 11
  - Alignment: Center
  - Borders: Thin borders on all sides

- **Data Rows**:
  - Text columns: Left-aligned, thin borders
  - Numeric columns (Quantity, volume_m3, etc.): Right-aligned, 3 decimal places
  - Borders: Thin borders on all cells
  - Row height: Auto-adjusted

- **Column Widths**: Auto-adjusted based on content (max 50 characters)

- **Frozen Panes**: Header row frozen (Row 1)

## Summary Sheet Format

| Metric | Value |
|--------|-------|
| Total Items | 25 |
| Total Volume M3 | 1520.750 |
| Total Area M2 | 2850.500 |
| Total Length M | 450.000 |
| Total Count | 45 |
| Element Types | IfcWall, IfcSlab, IfcColumn, IfcBeam, IfcFooting |

**Formatting:**
- Header: Green background (#70AD47), white bold text
- Data: Left-aligned text, right-aligned numbers

## Project Information Sheet Format

| Property | Value |
|----------|-------|
| Schema | IFC4 |
| File Path | C:\Projects\building_model.ifc |
| Unit Scale Factor | 0.001 |
| Base Unit | mm |
| Project Name | Sample Building Project |
| Project Id | 3xKJg8$fD9HxLzN5QmR7sT |
| Building Name | Main Building |
| Building Id | 2yMNg7#eC8GwKyM4PlQ6rS |

**Formatting:**
- Header: Blue background (#4472C4), white bold text
- Data: Left-aligned

## Unit Determination Logic

The primary unit (Column D) is determined based on:

1. **Volume (m³)**: For elements that typically use volume
   - IfcWall, IfcSlab, IfcFooting, IfcColumn (when volume available)
   - Quantity = total volume in m³

2. **Area (m²)**: For elements that typically use area
   - IfcRoof, IfcCurtainWall (when area available)
   - Quantity = total area in m²

3. **Length (m)**: For linear elements
   - IfcBeam, IfcPile (when length available)
   - Quantity = total length in m

4. **Count (No.)**: Fallback when no geometric quantities available
   - Quantity = number of elements

## Grouping Impact on Sheet Structure

### Grouping by Type (Default)
- Each element type gets its own sheet
- Items within each sheet are sorted by storey
- Example: "Wall" sheet contains all walls, grouped by storey

### Grouping by Storey
- Each storey gets its own sheet
- Items within each sheet are sorted by element type
- Example: "Ground Floor" sheet contains all elements on that floor

### Grouping by Material
- Each material gets its own sheet
- Items within each sheet are sorted by element type
- Example: "Concrete" sheet contains all concrete elements

### Grouping by All
- Most detailed grouping
- Multiple sheets based on combinations
- Example: "IfcWall_Ground Floor_Concrete" sheet

## Notes

1. **Empty Values**: When a quantity type is not available, the cell shows empty (not 0) to avoid confusion
2. **Rounding**: All quantities rounded to 3 decimal places
3. **Sheet Name Length**: Limited to 31 characters (Excel limitation)
4. **Special Characters**: Invalid characters in sheet names are replaced with underscores
5. **Multiple Quantities**: The primary quantity (Column E) is the main measure, but all quantities (volume, area, length) are preserved for reference

## Use Cases

This format is suitable for:
- **Cost Estimation**: Import quantities into cost databases
- **Progress Tracking**: Compare quantities across project phases
- **Material Ordering**: Calculate material requirements
- **Quality Control**: Verify quantities against design specifications
- **Reporting**: Include in project reports and documentation

---

**Note**: The exact number of sheets and data depends on the IFC file content and selected grouping option.
